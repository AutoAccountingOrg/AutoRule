const { get } = require('./main');

test("支付宝收款码收款", () => {
    const data = JSON.stringify(
        { "ariverRpcTraceId": "client`ZU4sULl9g50DAKQFbhdkTPuoOw9Ch6Q_5696097", "buttons": [], "code": 0, "degradeCardFromMrchorder": false, "extension": { "PID": "2088032022319723", "bizInNo": "2023122022001425671442609026", "bizType": "TRADE", "gmtBizCreateTime": "1703055625000", "is_display_marketing": "Y", "mdata": "{\"conbiz_biztype\":\"TRADE\",\"conbiz_bizinno\":\"2023122022001425671442609026\",\"conbiz_bizsubtype\":\"104\",\"conbiz_opp_uid\":\"2088622103925679\",\"conbiz_pid\":\"2088032022319723\"}", "processDate": "", "showGuaguaCard": "false", "tradeFrom": "6003", "tradeNumber": "2023122022001425671442609026" }, "fields": [{ "locationPage": "main", "templateId": "BLDetailTitle", "type": "birdNest", "value": "{\"icon\":\"https:\/\/t.alipayobjects.com\/images\/partner\/TB1C2W7c.iHDuNkUQcjXXXh_pXa_[pixelWidth]x.png\",\"content\":\"**江\"}" }, { "locationPage": "main", "templateId": "BLDetailPrice", "type": "birdNest", "value": "{\"amount\":\"+0.01\",\"status\":\"交易成功\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2023-12-20 15:00:25\",\"inOut\":0,\"needVerify\":false}],\"title\":\"创建时间\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"商品\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billDetailProductInfo\"}],\"title\":\"商品说明\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2023122022001425671442609026\",\"inOut\":0,\"needVerify\":false}],\"title\":\"订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailBarcode", "type": "birdNest", "value": "{\"seed\":\"billBarCodeInfo\",\"title\":\"商家订单号\",\"content\":\"商家可扫码退款或查询交易\",\"barCode\":\"17030556250622103925679\"}" }, { "locationPage": "main", "templateId": "BLDetailBlankArea", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLNewCategory", "type": "birdNest", "value": "{\"content\":\"收入\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billLifeCategory\",\"title\":\"账单分类\"}" }, { "locationPage": "main", "templateId": "BLTagAndEssay", "type": "birdNest", "value": "{\"data\":[{\"content\":\"\",\"goto\":\"alipays:\/\/platformapi\/startapp?appId=66666698&url=%2Fwww%2Findex.html%3FgmtBizCreate%3D1703055625000%26bizInNo%3D2023122022001425671442609026%26bizType%3DTRADE\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billTagAndEssay\",\"title\":\"标签和备注\"}]}" }, { "locationPage": "main", "templateId": "BLStatManage", "type": "birdNest", "value": "{\"content\":\"0\",\"inOut\":0,\"needVerify\":false,\"seed\":\"countswitch\",\"title\":\"计入收支\"}" }, { "locationPage": "main", "templateId": "BLDetailLink", "type": "birdNest", "value": "{\"data\":[{\"goto\":\"alipays:\/\/platformapi\/startApp?appId=20000076&actionType=toBillList&scene=CONTACT_BILL_DETAIL&oppositeCardNo=2088622103925679&title=**江\",\"inOut\":0,\"infoLevel\":\"80\",\"needVerify\":false,\"seed\":\"contactQuery\",\"title\":\"查看往来记录\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*sFVyQ5mQPpQAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=68687823&startMultApp=YES&appClearTop=false&url=%2Fwww%2FmultipleTrade.html%3Ftitle%3D**江%26oppositeCardNo%3D2088622103925679\",\"inOut\":0,\"infoLevel\":\"10\",\"needVerify\":false,\"seed\":\"ProofOfTransaction\",\"title\":\"往来流水证明\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*zv5nToAdXLgAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=68687823&url=%2Fwww%2Freceipt.html%3FbizInNo%3D2023122022001425671442609026%26bizType%3DTRADE%26bizSubType%3D104%26userId%3D2088032022319723\",\"inOut\":0,\"infoLevel\":\"10\",\"needVerify\":false,\"seed\":\"voucher\",\"title\":\"申请电子回单\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*cJS2S6LFZlIAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"https:\/\/render.alipay.com\/p\/h5\/contactPayee\/www\/contactBuyer.html?tradeNo=2023122022001425671442609026\",\"inOut\":0,\"infoLevel\":\"5\",\"needVerify\":false,\"seed\":\"contactBuyer\",\"title\":\"联系付款方\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*LlTqSbUK3wEAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700256&query=scene%3dmbill_tips%26bizNo%3d2023122022001425671442609026\",\"inOut\":0,\"infoLevel\":\"3\",\"needVerify\":false,\"seed\":\"selfHelp\",\"title\":\"对此订单有疑问\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*JprOQZFp2u8AAAAAAAAAAAAADoWDAQ\/original\"}]}" }], "logisticsModel": { "nodes": [] }, "needDisplayCardStyle": true, "needDisplayConsumeRate": true, "refundModel": { "fundBatch": [] }, "showAuthPage": false, "succ": true, "switchNewVersion": true }
    );

    let result = get(data);

    expect(result).toEqual({
        type: 1,
        money: 0.01,
        fee: 0,
        shopName: '**江',
        shopItem: '商品',
        accountNameFrom: '余额',
        accountNameTo: '',
        currency: 'CNY',
        time: 1703055625000,
        channel: '支付宝收款码收款'
    });
});

test("支付宝收钱码服务费", () => {
    const data = JSON.stringify(
        { "ariverRpcTraceId": "client`ZU4sULl9g50DAKQFbhdkTPuoOw9Cf+A_5696085", "buttons": [], "code": 0, "degradeCardFromMrchorder": false, "extension": { "bizInNo": "2024011028013000670001100084100926", "bizType": "CHARGE", "gmtBizCreateTime": "1704854659000", "is_display_marketing": "Y", "mdata": "{\"conbiz_biztype\":\"CHARGE\",\"conbiz_bizinno\":\"2024011028013000670001100084100926\",\"conbiz_bizsubtype\":\"1803\",\"conbiz_opp_uid\":\"2088001368431899\",\"conbiz_pid\":\"2088032022319723\"}", "processDate": "", "showGuaguaCard": "false", "tradeNumber": "2024011028013000670001100084100926" }, "fields": [{ "locationPage": "main", "templateId": "BLDetailTitle", "type": "birdNest", "value": "{\"icon\":\"https:\/\/os.alipayobjects.com\/static\/i\/mobileapp\/png\/201509\/5rNQKGl6CL.png\",\"content\":\"支付宝(中国)网络技术有限公司\"}" }, { "locationPage": "main", "templateId": "BLDetailPrice", "type": "birdNest", "value": "{\"amount\":\"-9.50\",\"status\":\"交易成功\"}" }, { "locationPage": "main", "templateId": "BLDetailCommonWithDialog", "type": "birdNest", "value": "{\"groupBizType\":\"TRADE\",\"seed\":\"billRelationInfo\",\"jumpMode\":\"POPUP\",\"groupBizNo\":\"2024011022001425671431559132\",\"title\":\"关联记录\",\"content\":\"查看关联记录\",\"gotoStyle\":\"TEXT_LINK\"}" }, { "locationPage": "main", "templateId": "BLDetailLine", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024-01-10 10:44:19\",\"inOut\":0,\"needVerify\":false}],\"title\":\"创建时间\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"收钱码经营版信用卡收钱服务费[2024011022001425671431559132]\",\"inOut\":0,\"needVerify\":false}],\"title\":\"商品说明\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024011028013000670001100084100926\",\"inOut\":0,\"needVerify\":false}],\"title\":\"订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024011022001425671431559132\",\"inOut\":0,\"needVerify\":false}],\"title\":\"商家订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailBlankArea", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLNewCategory", "type": "birdNest", "value": "{\"content\":\"商业服务\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billLifeCategory\",\"title\":\"账单分类\"}" }, { "locationPage": "main", "templateId": "BLTagAndEssay", "type": "birdNest", "value": "{\"data\":[{\"content\":\"\",\"goto\":\"alipays:\/\/platformapi\/startapp?appId=66666698&url=%2Fwww%2Findex.html%3FgmtBizCreate%3D1704854659000%26bizInNo%3D2024011028013000670001100084100926%26bizType%3DCHARGE\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billTagAndEssay\",\"title\":\"标签和备注\"}]}" }, { "locationPage": "main", "templateId": "BLStatManage", "type": "birdNest", "value": "{\"content\":\"0\",\"inOut\":0,\"needVerify\":false,\"seed\":\"countswitch\",\"title\":\"计入收支\"}" }, { "locationPage": "main", "templateId": "BLDetailLink", "type": "birdNest", "value": "{\"data\":[{\"goto\":\"alipays:\/\/platformapi\/startApp?appId=20000076&actionType=toBillLWList&scene=CONTACT_BILL_DETAIL&contactType=otherConsume&contactId=2088001368431899&bizSubType=1803&instId=null&oppositeInfo=支付宝(中国)网络技术有限公司\",\"inOut\":0,\"infoLevel\":\"80\",\"needVerify\":false,\"seed\":\"contactQuery\",\"title\":\"查看往来记录\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*sFVyQ5mQPpQAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700256&query=scene%3dmbill_tips%26bizNo%3d2024011028013000670001100084100926\",\"inOut\":0,\"infoLevel\":\"3\",\"needVerify\":false,\"seed\":\"selfHelp\",\"title\":\"对此订单有疑问\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*JprOQZFp2u8AAAAAAAAAAAAADoWDAQ\/original\"}]}" }], "logisticsModel": { "nodes": [] }, "needDisplayCardStyle": true, "needDisplayConsumeRate": true, "refundModel": { "fundBatch": [] }, "showAuthPage": false, "succ": true, "switchNewVersion": true }
    );

    let result = get(data);

    expect(result).toEqual({
        type: 0,
        money: 9.50,
        fee: 0,
        shopName: "支付宝(中国)网络技术有限公司",
        shopItem: "收钱码经营版信用卡收钱服务费[2024011022001425671431559132]",
        accountNameFrom: "余额",
        accountNameTo: "",
        currency: "CNY",
        time: 1704854659000,
        channel: "支付宝收钱码经营版信用卡收钱服务费"
    });
});

test("支付宝余额转到余额宝", () => {
    const data = JSON.stringify(
        { "ariverRpcTraceId": "client`ZU4sULl9g50DAKQFbhdkTPuoOw9CetY_5696072", "buttons": [], "code": 0, "degradeCardFromMrchorder": false, "extension": { "bizInNo": "20240310009130125000720001331684", "bizType": "YEB", "gmtBizCreateTime": "1710046787000", "mdata": "{\"conbiz_biztype\":\"YEB\",\"conbiz_bizinno\":\"20240310009130125000720001331684\",\"conbiz_bizsubtype\":\"8001\",\"conbiz_opp_uid\":\"2088421945423998\"}" }, "fields": [{ "locationPage": "main", "templateId": "BLDetailTitle", "type": "birdNest", "value": "{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=20000032&isOpenedFund=true\",\"icon\":\"https:\/\/gw.alipayobjects.com\/mdn\/rms_b03cca\/afts\/img\/A*YczITbg-JhMAAAAAAAAAAAAAARQnAQ\",\"content\":\"余额宝\"}" }, { "locationPage": "main", "templateId": "BLDetailPrice", "type": "birdNest", "value": "{\"amount\":\"0.01\",\"status\":\"交易成功\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024-03-10 12:59:47\",\"inOut\":0,\"needVerify\":false}],\"title\":\"创建时间\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"账户余额\",\"extInfo\":{},\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700300&page=\/pages\/balance-detail-list\/index\",\"inOut\":2,\"needVerify\":false,\"seed\":\"billPayToolInfo\"}],\"title\":\"付款方式\"}" }, { "locationPage": "main", "templateId": "BLH5ProductInfo", "type": "birdNest", "value": "{\"data\":[{\"content\":\"转账收款到余额宝\",\"goUrlTitle\":\"查看详情\",\"goto\":\"alipays:\/\/platformapi\/startApp?appId=77700301&bizScenario=bill_detail&page=pages\/yuebaoAutoTransfer\/index\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billDetailProductInfo\"}],\"title\":\"商品说明\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"20240310009130125000720001331684\",\"inOut\":0,\"needVerify\":false}],\"title\":\"订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailBlankArea", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLNewCategory", "type": "birdNest", "value": "{\"content\":\"投资理财\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billLifeCategory\",\"title\":\"账单分类\"}" }, { "locationPage": "main", "templateId": "BLTagAndEssay", "type": "birdNest", "value": "{\"data\":[{\"content\":\"\",\"goto\":\"alipays:\/\/platformapi\/startapp?appId=66666698&url=%2Fwww%2Findex.html%3FgmtBizCreate%3D1710046787000%26bizInNo%3D20240310009130125000720001331684%26bizType%3DYEB\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billTagAndEssay\",\"title\":\"标签和备注\"}]}" }, { "locationPage": "main", "templateId": "BLStatManage", "type": "birdNest", "value": "{\"content\":\"1\",\"inOut\":0,\"needVerify\":false,\"seed\":\"countswitch\",\"title\":\"计入收支\"}" }, { "locationPage": "main", "templateId": "BLDetailLink", "type": "birdNest", "value": "{\"data\":[{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700256&query=scene%3dmbill_tips%26bizNo%3d20240310009130125000720001331684\",\"inOut\":0,\"infoLevel\":\"3\",\"needVerify\":false,\"seed\":\"selfHelp\",\"title\":\"对此订单有疑问\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*JprOQZFp2u8AAAAAAAAAAAAADoWDAQ\/original\"}]}" }], "logisticsModel": { "nodes": [] }, "needDisplayCardStyle": true, "needDisplayConsumeRate": true, "refundModel": { "fundBatch": [] }, "showAuthPage": false, "succ": true, "switchNewVersion": true }
    );

    let result = get(data);

    expect(result).toEqual({
        type: 2,
        money: 0.01,
        fee: 0,
        shopName: "余额宝",
        shopItem: "转账收款到余额宝",
        accountNameFrom: "余额",
        accountNameTo: "余额宝",
        currency: "CNY",
        time: 1710046787000,
        channel: "支付宝余额转到余额宝"
    });
});

test("支付宝转账收款", () => {
    const data = JSON.stringify(
        { "ariverRpcTraceId": "client`ZU4sULl9g50DAKQFbhdkTPuoOw9CeC+_5696066", "buttons": [], "code": 0, "degradeCardFromMrchorder": false, "extension": { "bizInNo": "20240310200040011100670052420838", "bizType": "D_TRANSFER", "gmtBizCreateTime": "1710075615000", "mdata": "{\"conbiz_biztype\":\"D_TRANSFER\",\"conbiz_bizinno\":\"20240310200040011100670052420838\",\"conbiz_bizsubtype\":\"1106\",\"conbiz_opp_uid\":\"2088622103925679\"}" }, "fields": [{ "locationPage": "main", "templateId": "BLDetailTitle", "type": "birdNest", "value": "{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=09999988&actionType=toAccount&userId=2088622103925679&sourceId=bill\",\"icon\":\"https:\/\/t.alipayobjects.com\/images\/partner\/TB1C2W7c.iHDuNkUQcjXXXh_pXa_[pixelWidth]x.png\",\"content\":\"从前慢\"}" }, { "locationPage": "main", "templateId": "BLDetailPrice", "type": "birdNest", "value": "{\"amount\":\"+0.01\",\"status\":\"交易成功\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024-03-10 21:00:15\",\"inOut\":0,\"needVerify\":false}],\"title\":\"创建时间\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"转账\",\"inOut\":0,\"needVerify\":false}],\"title\":\"转账备注\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"从前慢 185******30\",\"inOut\":0,\"needVerify\":false}],\"title\":\"对方账户\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"20240310200040011100670052420838\",\"inOut\":0,\"needVerify\":false}],\"title\":\"订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailBlankArea", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLNewCategory", "type": "birdNest", "value": "{\"content\":\"转账红包\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billLifeCategory\",\"title\":\"账单分类\"}" }, { "locationPage": "main", "templateId": "BLTagAndEssay", "type": "birdNest", "value": "{\"data\":[{\"content\":\"\",\"goto\":\"alipays:\/\/platformapi\/startapp?appId=66666698&url=%2Fwww%2Findex.html%3FgmtBizCreate%3D1710075615000%26bizInNo%3D20240310200040011100670052420838%26bizType%3DD_TRANSFER\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billTagAndEssay\",\"title\":\"标签和备注\"}]}" }, { "locationPage": "main", "templateId": "BLStatManage", "type": "birdNest", "value": "{\"content\":\"0\",\"inOut\":0,\"needVerify\":false,\"seed\":\"countswitch\",\"title\":\"计入收支\"}" }, { "locationPage": "main", "templateId": "BLDetailLink", "type": "birdNest", "value": "{\"data\":[{\"goto\":\"alipays:\/\/platformapi\/startApp?appId=20000076&actionType=toBillList&scene=CONTACT_BILL_DETAIL&oppositeCardNo=2088622103925679&title=从前慢\",\"inOut\":0,\"infoLevel\":\"80\",\"needVerify\":false,\"seed\":\"contactQuery\",\"title\":\"查看往来记录\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*sFVyQ5mQPpQAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=68687823&startMultApp=YES&appClearTop=false&url=%2Fwww%2FmultipleTrade.html%3Ftitle%3D从前慢%26oppositeCardNo%3D2088622103925679\",\"inOut\":0,\"infoLevel\":\"10\",\"needVerify\":false,\"seed\":\"ProofOfTransaction\",\"title\":\"往来流水证明\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*zv5nToAdXLgAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=68687823&url=%2Fwww%2Freceipt.html%3FbizInNo%3D20240310200040011100670052420838%26bizType%3DD_TRANSFER%26bizSubType%3D1106%26userId%3D2088032022319723\",\"inOut\":0,\"infoLevel\":\"10\",\"needVerify\":false,\"seed\":\"voucher\",\"title\":\"申请电子回单\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*cJS2S6LFZlIAAAAAAAAAAAAADoWDAQ\/original\"},{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700256&query=scene%3dmbill_tips%26bizNo%3d20240310200040011100670052420838\",\"inOut\":0,\"infoLevel\":\"3\",\"needVerify\":false,\"seed\":\"selfHelp\",\"title\":\"对此订单有疑问\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*JprOQZFp2u8AAAAAAAAAAAAADoWDAQ\/original\"}]}" }], "logisticsModel": { "nodes": [] }, "needDisplayCardStyle": true, "needDisplayConsumeRate": true, "refundModel": { "fundBatch": [] }, "showAuthPage": false, "succ": true, "switchNewVersion": true }
    );

    let result = get(data);

    expect(result).toEqual({
        type: 1, // 0为支出，1为收入，2为转账
        money: 0.01,
        fee: 0,
        shopName: "从前慢",
        shopItem: "转账",
        accountNameFrom: "余额",
        accountNameTo: "",
        currency: "CNY",
        time: 1710075615000,
        channel: "支付宝转账收款"
    });
});

test("支付宝余额转到余额宝", () => {
    const data = JSON.stringify(
        { "ariverRpcTraceId": "client`ZU4sULl9g50DAKQFbhdkTPuoOw9CdQL_5696062", "buttons": [], "code": 0, "degradeCardFromMrchorder": false, "extension": { "bizInNo": "20240310009130125000720001057848", "bizType": "YEB", "gmtBizCreateTime": "1710075624000", "mdata": "{\"conbiz_biztype\":\"YEB\",\"conbiz_bizinno\":\"20240310009130125000720001057848\",\"conbiz_bizsubtype\":\"8001\",\"conbiz_opp_uid\":\"2088421945423998\"}" }, "fields": [{ "locationPage": "main", "templateId": "BLDetailTitle", "type": "birdNest", "value": "{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=20000032&isOpenedFund=true\",\"icon\":\"https:\/\/gw.alipayobjects.com\/mdn\/rms_b03cca\/afts\/img\/A*YczITbg-JhMAAAAAAAAAAAAAARQnAQ\",\"content\":\"余额宝\"}" }, { "locationPage": "main", "templateId": "BLDetailPrice", "type": "birdNest", "value": "{\"amount\":\"0.01\",\"status\":\"交易成功\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024-03-10 21:00:24\",\"inOut\":0,\"needVerify\":false}],\"title\":\"创建时间\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"账户余额\",\"extInfo\":{},\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700300&page=\/pages\/balance-detail-list\/index\",\"inOut\":2,\"needVerify\":false,\"seed\":\"billPayToolInfo\"}],\"title\":\"付款方式\"}" }, { "locationPage": "main", "templateId": "BLH5ProductInfo", "type": "birdNest", "value": "{\"data\":[{\"content\":\"转账收款到余额宝\",\"goUrlTitle\":\"查看详情\",\"goto\":\"alipays:\/\/platformapi\/startApp?appId=77700301&bizScenario=bill_detail&page=pages\/yuebaoAutoTransfer\/index\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billDetailProductInfo\"}],\"title\":\"商品说明\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"20240310009130125000720001057848\",\"inOut\":0,\"needVerify\":false}],\"title\":\"订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailBlankArea", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLNewCategory", "type": "birdNest", "value": "{\"content\":\"投资理财\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billLifeCategory\",\"title\":\"账单分类\"}" }, { "locationPage": "main", "templateId": "BLTagAndEssay", "type": "birdNest", "value": "{\"data\":[{\"content\":\"\",\"goto\":\"alipays:\/\/platformapi\/startapp?appId=66666698&url=%2Fwww%2Findex.html%3FgmtBizCreate%3D1710075624000%26bizInNo%3D20240310009130125000720001057848%26bizType%3DYEB\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billTagAndEssay\",\"title\":\"标签和备注\"}]}" }, { "locationPage": "main", "templateId": "BLStatManage", "type": "birdNest", "value": "{\"content\":\"1\",\"inOut\":0,\"needVerify\":false,\"seed\":\"countswitch\",\"title\":\"计入收支\"}" }, { "locationPage": "main", "templateId": "BLDetailLink", "type": "birdNest", "value": "{\"data\":[{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700256&query=scene%3dmbill_tips%26bizNo%3d20240310009130125000720001057848\",\"inOut\":0,\"infoLevel\":\"3\",\"needVerify\":false,\"seed\":\"selfHelp\",\"title\":\"对此订单有疑问\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*JprOQZFp2u8AAAAAAAAAAAAADoWDAQ\/original\"}]}" }], "logisticsModel": { "nodes": [] }, "needDisplayCardStyle": true, "needDisplayConsumeRate": true, "refundModel": { "fundBatch": [] }, "showAuthPage": false, "succ": true, "switchNewVersion": true }
    );

    let result = get(data);

    expect(result).toEqual({
        type: 2,
        money: 0.01,
        fee: 0,
        shopName: "余额宝",
        shopItem: "转账收款到余额宝",
        accountNameFrom: "余额",
        accountNameTo: "余额宝",
        currency: "CNY",
        time: 1710075624000,
        channel: "支付宝余额转到余额宝"
    });
});

test("余额宝收益发放", () => {
    const data = JSON.stringify(
        { "ariverRpcTraceId": "client`ZU4sULl9g50DAKQFbhdkTPuoOw9CO6k_5696040", "buttons": [], "code": 0, "degradeCardFromMrchorder": false, "extension": { "bizInNo": "20240326315575111721", "bizType": "MINITRANS", "gmtBizCreateTime": "1711393834000", "mdata": "{\"conbiz_biztype\":\"MINITRANS\",\"conbiz_bizinno\":\"20240326315575111721\",\"conbiz_bizsubtype\":\"8041\"}" }, "fields": [{ "locationPage": "main", "templateId": "BLDetailTitle", "type": "birdNest", "value": "{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=20000032&isOpenedFund=true\",\"icon\":\"https:\/\/gw.alipayobjects.com\/mdn\/rms_b03cca\/afts\/img\/A*YczITbg-JhMAAAAAAAAAAAAAARQnAQ\",\"content\":\"长城基金管理有限公司\"}" }, { "locationPage": "main", "templateId": "BLDetailPrice", "type": "birdNest", "value": "{\"amount\":\"0.01\",\"status\":\"交易成功\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"2024-03-26 03:10:34\",\"inOut\":0,\"needVerify\":false}],\"title\":\"创建时间\"}" }, { "locationPage": "main", "templateId": "BLH5ProductInfo", "type": "birdNest", "value": "{\"data\":[{\"content\":\"余额宝-2024.03.25-收益发放\",\"goUrlTitle\":\"查看收益明细\",\"goto\":\"alipays:\/\/platformapi\/startapp?appClearTop=false&appId=68687356&startMultApp=YES&url=%2Fwww%2Fmy.html%3Ffrom%3DtotalProfit%26enableWK%3DYES\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billDetailProductInfo\"}],\"title\":\"商品说明\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"长城基金管理有限公司\",\"inOut\":0,\"needVerify\":false}],\"title\":\"对方账户\"}" }, { "locationPage": "main", "templateId": "BLDetailCommon", "type": "birdNest", "value": "{\"data\":[{\"content\":\"20240326315575111721\",\"inOut\":0,\"needVerify\":false}],\"title\":\"订单号\"}" }, { "locationPage": "main", "templateId": "BLDetailBlankArea", "type": "birdNest" }, { "locationPage": "main", "templateId": "BLNewCategory", "type": "birdNest", "value": "{\"content\":\"投资理财\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billLifeCategory\",\"title\":\"账单分类\"}" }, { "locationPage": "main", "templateId": "BLTagAndEssay", "type": "birdNest", "value": "{\"data\":[{\"content\":\"\",\"goto\":\"alipays:\/\/platformapi\/startapp?appId=66666698&url=%2Fwww%2Findex.html%3FgmtBizCreate%3D1711393834000%26bizInNo%3D20240326315575111721%26bizType%3DMINITRANS\",\"inOut\":0,\"needVerify\":false,\"seed\":\"billTagAndEssay\",\"title\":\"标签和备注\"}]}" }, { "locationPage": "main", "templateId": "BLStatManage", "type": "birdNest", "value": "{\"content\":\"1\",\"inOut\":0,\"needVerify\":false,\"seed\":\"countswitch\",\"title\":\"计入收支\"}" }, { "locationPage": "main", "templateId": "BLDetailLink", "type": "birdNest", "value": "{\"data\":[{\"goto\":\"alipays:\/\/platformapi\/startapp?appId=77700256&query=scene%3dmbill_tips%26bizNo%3d20240326315575111721\",\"inOut\":0,\"infoLevel\":\"3\",\"needVerify\":false,\"seed\":\"selfHelp\",\"title\":\"对此订单有疑问\",\"titleLogo\":\"https:\/\/mdn.alipayobjects.com\/huamei_6cknvu\/afts\/img\/A*JprOQZFp2u8AAAAAAAAAAAAADoWDAQ\/original\"}]}" }], "logisticsModel": { "nodes": [] }, "needDisplayCardStyle": true, "needDisplayConsumeRate": true, "refundModel": { "fundBatch": [] }, "showAuthPage": false, "succ": true, "switchNewVersion": true }
    );

    let result = get(data);

    expect(result).toEqual({
        type: 1,
        money: 0.01,
        fee: 0,
        shopName: "长城基金管理有限公司",
        shopItem: "余额宝-2024.03.25-收益发放",
        accountNameFrom: "余额宝",
        accountNameTo: "",
        currency: "CNY",
        time: 1711393834000,
        channel: "支付宝余额宝收益发放"
    });
});
